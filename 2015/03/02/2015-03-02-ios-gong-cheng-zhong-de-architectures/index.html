<!DOCTYPE html>
<html lang="z">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    <title>iOS 工程中的 Architectures | Charvel 互联网自留地</title>
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="Arm 是什么Arm 处理器是 Arm 公司面向市场推出的 RISC(精简指令集) 微处理器，目前手机上的 CPU 都是 RISC 类型，跟传统 PC 端的 CPU(CISC) 相比，具有体积小、低功耗、低成本、高性能的特点，很适合于移动终端。一般电脑上的 CPU 都是 CISC 类型的，iOS 模拟器是将 Arm 指令转换后在 X86 上运行。另外，Apple 本身就是 ARM 最大的股东之一。">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="iOS 工程中的 Architectures | Charvel 互联网自留地">
    <meta name="twitter:description" content="Arm 是什么Arm 处理器是 Arm 公司面向市场推出的 RISC(精简指令集) 微处理器，目前手机上的 CPU 都是 RISC 类型，跟传统 PC 端的 CPU(CISC) 相比，具有体积小、低功耗、低成本、高性能的特点，很适合于移动终端。一般电脑上的 CPU 都是 CISC 类型的，iOS 模拟器是将 Arm 指令转换后在 X86 上运行。另外，Apple 本身就是 ARM 最大的股东之一。">

    <meta property="og:type" content="article">
    <meta property="og:title" content="iOS 工程中的 Architectures | Charvel 互联网自留地">
    <meta property="og:description" content="Arm 是什么Arm 处理器是 Arm 公司面向市场推出的 RISC(精简指令集) 微处理器，目前手机上的 CPU 都是 RISC 类型，跟传统 PC 端的 CPU(CISC) 相比，具有体积小、低功耗、低成本、高性能的特点，很适合于移动终端。一般电脑上的 CPU 都是 CISC 类型的，iOS 模拟器是将 Arm 指令转换后在 X86 上运行。另外，Apple 本身就是 ARM 最大的股东之一。">

    
    <meta name="author" content="Well Cheng">
    
    <link rel="stylesheet" href="/css/vno.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

    
    <link rel="icon" href="/images/avatar-small.png">
    

    <meta name="generator" content="hexo"/>
    
    <link rel="alternate" type="application/rss+xml" title="Charvel 互联网自留地" href="/atom.xml">
    

    <link rel="canonical" href="http://blog.devcheng.com/2015/03/02/2015-03-02-ios-gong-cheng-zhong-de-architectures/"/>

                 
</head>

<body class="home-template no-js">
    <script src="//cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>

    
<header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/" title="前往 Charvel 互联网自留地 的主页"><img src="/images/avatar.jpg" width="80" alt="Charvel 互联网自留地 logo" class="panel-cover__logo logo"></a>
        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage for Charvel 互联网自留地">Charvel 互联网自留地</a></h1>
        
        <span class="panel-cover__subtitle panel-subtitle">记录生活的点点滴滴，记录技术的淅淅沥沥</span>
        
        <hr class="panel-cover__divider">
        <p class="panel-cover__description"></p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">
          <div>
          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="Visit the blog" class="blog-button">Blog</a></li>
            
              <li class="navigation__item"><a href="/favourite">黄金屋</a></li>
            
              <li class="navigation__item"><a href="/favourite/time.html">时光机</a></li>
            
              <li class="navigation__item"><a href="/favourite/image.html">幻想间</a></li>
            
              <li class="navigation__item"><a href="/aboutme">关于我</a></li>
            
            </ul>
          </nav>
          </div>
          <div>
          <nav class="cover-navigation navigation--social">
  <ul class="navigation">

  <!-- Weibo-->
  

  <!-- Github -->
  
  <li class="navigation__item">
    <a href="https://github.com/monniya" title="GitHub" target="_blank">
      <i class="social fa fa-github"></i>
      <span class="label">Github</span>
    </a>
  </li>


<!-- Stack Overflow -->
        

  <!-- Google Plus -->
  

<!-- Facebook -->

  
<!-- Twitter -->

  <li class="navigation__item">
    <a href="https://twitter.com/onlymonniya" title="Twitter" target="_blank">
      <i class="social fa fa-twitter"></i>
      <span class="label">Twitter</span>
    </a>
  </li>

  

  <li class="navigation__item">
    <a href="/atom.xml" title="RSS" target="_blank">
      <i class="social fa fa-rss"></i>
      <span class="label">RSS</span>
    </a>
  </li>


  <li class="navigation__item">
    <a href="mailto:chengwei3269@hotmail.com" title="Mail" target="_blank">
      <i class="social fa fa-envelope"></i>
      <span class="label">Email</span>
    </a>
  </li>


  </ul>
</nav>

          </div>
        </div>

      </div>

    </div>

    <div class="panel-cover--overlay cover-purple"></div>
  </div> 
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single">

  <header class="post-header">
    <div class="post-meta">
      <time datetime="2015-03-02T03:05:58.000Z" class="post-list__meta--date date">2015-03-02</time> &#8226; <span class="post-meta__tags tags">于  </span>
      <span class="page-pv">
       Read <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>
      </span> 
   
    </div>
    <h1 class="post-title">iOS 工程中的 Architectures</h1>
  </header>

  <section class="post">
    <h2 id="Arm-是什么"><a href="#Arm-是什么" class="headerlink" title="Arm 是什么"></a>Arm 是什么</h2><p>Arm 处理器是 Arm 公司面向市场推出的 RISC(精简指令集) 微处理器，目前手机上的 CPU 都是 RISC 类型，跟传统 PC 端的 CPU(CISC) 相比，具有体积小、低功耗、低成本、高性能的特点，很适合于移动终端。一般电脑上的 CPU 都是 CISC 类型的，iOS 模拟器是将 Arm 指令转换后在 X86 上运行。另外，Apple 本身就是 ARM 最大的股东之一。</p>
<a id="more"></a>
<h2 id="Apple-系列产品的-Arm-架构"><a href="#Apple-系列产品的-Arm-架构" class="headerlink" title="Apple 系列产品的 Arm 架构"></a>Apple 系列产品的 Arm 架构</h2><p>Armv6 的设备有 </p>
<p><code>iPhone 1,2,3 代</code>、 <code>iPod 1,2 代</code>  </p>
<p>Armv7 的设备有 </p>
<p><code>iPhone 3GS</code>、<code>iPhone 4</code>、<code>iPhone 4s</code>、</p>
<p><code>iPad</code>、<code>iPad 2</code>、<code>(iPad 3)the new iPad</code>、<code>iPad mini</code>、</p>
<p><code>iPod touch 3G</code>、<code>iPod touch 4</code></p>
<p>Armv7s 的设备有 </p>
<p><code>iPhone 5</code>、<code>iPhone 5c</code><br><code>iPad 4</code></p>
<p>Arm64 的设备有 <code>iPhone 5s</code>、<code>iPhone 6</code>、<code>iPhone 6 plus</code></p>
<p><code>iPad mini 2</code>、<code>iPad mini 3</code>、<code>iPad Air</code>、<code>iPad Air 2</code></p>
<p>可以看到，再以后的产品线中，应该全部都是支持 64 位了，如果是这样子，App 如果不支持64位，那么处理器再厉害也是白搭，性能损耗太大，苹果今年（2015）有关新上线 App 必须支持64位的决定也是有一定道理的。有关 App 如何支持64位的博客我会尽快的翻译官方的 GUI。</p>
<h2 id="Xcode-中的-Architectures-配置"><a href="#Xcode-中的-Architectures-配置" class="headerlink" title="Xcode 中的 Architectures 配置"></a>Xcode 中的 Architectures 配置</h2><p>Xcode 中有关指令集的配置如下图所示：</p>
<p><img src="http://7vzucb.com1.z0.glb.clouddn.com/blog.Architectures.png" alt="Architectures Xcode 截图"></p>
<p>####Architectures:</p>
<p>表示工程将被编译成支持哪些指令集，支持指令集是通过编译生成对应的二进制数据包实现的，如果选择支持多个指令集，会造成编译出的数据包很大。Xcode 6 目前的默认设置为 <code>$(ARCHS_STANDARD)(armv7,arm64)</code> ,armv7 包含了 Apple 的绝大数产品线，不包含的基本上已经被市场淘汰了，但是如果选择 armv7s，那么支持的 iOS 设备将会减少很多，另外 armv7 和 armv7s 性能差异比较小，所以 Apple 选择了 armv7，不排除以后 Xcode 升级修改到 armv7s。还有一个 arm64，这个就是让支持64位的设备全部运行64位数据包，由于64位与32位之间的性能差距比较大，再加上现在所有的 App 都需要支持64位，以后的 Xcode 配置中这一项不用改动，就按这个默认的 <code>$(ARCHS_STANDARD)</code> 来就行了。</p>
<p>####Build Active Architecture Only:</p>
<p>这个设置项是一个 BOOL 值，相当于一个开关，其意思是说，如果开关打开的话，我当前选择的设备是什么，我就编译跟设备匹配的二进制包。一般来说 Debug 模式下设置为 YES，这样子在测试 App 的时候，编译器只需要编译一种包，极大的减少了编译时间。Release 模式下设置为 NO，Release 模式主要是指打包为 ipa 分发测试或上线到 AppStore，这个时候你根本不知道安装 App 的设备是什么，当然是选择 NO，让编译起编译你所有想要支持的二进制包啦。</p>
<p>####Valid Architectures:</p>
<p>这里选择的是可能要编译的指令集，<code>Valid Architectures</code> 与 <code>Architectures</code> 指令集的交集，才会是 Xcode 最终编译出来的二进制包支持的指令集。如果此项为空，那么 Xcode 将不会编译任何东西。如果对 App 的体积有要求，可以在此项中设置最小的指令支持，但还是必须支持64位哦～</p>
<p>只要理解了 iOS 设备与指令集的关系，以后如果项目中遇到了指令集编译方面的错误，就可以迎刃而解了，尤其是使用第三方的 .a 静态库时，可能会出各种问题，其中很多问题都是指令集造成的，尤其是那些 <em>年代久远</em> 的库。</p>
<h4 id="查看指定静态库所支持的指令集"><a href="#查看指定静态库所支持的指令集" class="headerlink" title="查看指定静态库所支持的指令集"></a>查看指定静态库所支持的指令集</h4><p>比如要查看 libExample.a 这个静态库所支持的指令集，只需要 lipo 一下就好了</p>
<pre><code>lipo -info libExample.a
</code></pre><p>我自己在电脑上测试某 SDK 的库，得到的结果如下:</p>
<pre><code>Architectures in the fat file: output/Libxxx/libxxx.a are: armv7 armv7s i386 x86_64 arm64 
</code></pre><p>可以见得，在写 SDK 时，最好是 <strong>全部都支持</strong> ，这样子才不会给使用 SDK 的开发者造成麻烦。</p>

  </section>

</article>

<section class="read-more">
           
    
               
            <div class="read-more-item">
                <span class="read-more-item-dim">Newer Post</span>
                <h2 class="post-list__post-title post-title"><a href="/2015/03/02/2015-03-02-64-bit-transition-guide-for-cocoa-touch-yi-wen-,ru-he-rang-ni-de-app-zhi-chi-64wei/" title="64-Bit Transition Guide for Cocoa Touch 译文，如何让你的App 支持64位">64-Bit Transition Guide for Cocoa Touch 译文，如何让你的App 支持64位</a></h2>
                <p class="excerpt">
                
                Apple 为了让搭载64位处理器的 iOS 设备性能得到发挥，下了最后通牒：

As we announced in October, beginning February 1, 2015 new iOS apps submitted to the App Store must include 64-bit support and be built with the iOS 8 SDK. Beginning June 1, 2015 app updates will also need to follow the same requirements.


从 2015 年 2 月 1 日开始，所有新提交的 App 必须支持64位，并且使用 iOS8 SDK 编译，从 2015 年 6 月 1 日开始，更新版本的 App 也需要这样做。

                &hellip;
                </p>
                <div class="post-list__meta"><time datetime="2015-03-02T10:10:26.000Z" class="post-list__meta--date date">2015-03-02</time> &#8226; <span class="post-list__meta--tags tags">于 
  <a class="tag-link" href="/tags/翻译/">翻译</a>
</span><a class="btn-border-small" href="/2015/03/02/2015-03-02-64-bit-transition-guide-for-cocoa-touch-yi-wen-,ru-he-rang-ni-de-app-zhi-chi-64wei/">继续阅读</a></div>
                           
            </div>
        
        
        
     
   
   
  
</section>

  

            <footer class="footer">
    <span class="footer__copyright">
        &copy; 2019 Well Cheng - 本站点采用 <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>
       
    </span>
    <span class="footer__copyright">
             - 基于 <a href="http://hexo.io">Hexo</a> 搭建，使用 <a href="https://github.com/monniya/hexo-theme-new-vno ">new-vno</a> 主题，由<a href="https://monniya.com ">@Monniya</a> 修改自 <a href="https://github.com/lenbo-ma/hexo-theme-vno" target="_blank">Vno</a>, 原创出自<a href="http://github.com/onevcat/vno" target="_blank">onevcat</a>
         </span>
       
    
    
</footer>


        </div>
    </div>

     
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-78918255-1', 'auto');
	ga('send', 'pageview');
</script>

    
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?9cdad07c755fa23f6aced510c6760e87";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>



    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    
</body>
</html>
